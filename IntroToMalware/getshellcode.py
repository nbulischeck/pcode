#!/usr/bin/env python

import re
import sys
import os.path
import subprocess

if len(sys.argv) == 1:
	print ("Filename argument required:\n./getshellcode.py binary")
else:
	binary = sys.argv[1]
	shellcode = ""
	if os.path.exists(binary):
		output = subprocess.check_output(["objdump -d " + binary], shell=True)
		print("This is the output:")
		print (output)
		print("Attempting to parse:")
		output = re.findall(r'\:.(.*)', output)
		for i in output:
			i = re.findall(r'(.*)\t', i)
			if i:
				i = i[0].strip()
				i = i.replace(" ", "\\x")
				i = "\\x" + i
				shellcode += i
		print shellcode
	else:
		print 'Binary named \'' + binary + '\' not found.'

